# dblstreamgen v0.1.0 Configuration Example
# 
# This configuration demonstrates generating synthetic streaming data
# for a generic web application use case.

# ============================================================================
# MAIN CONFIGURATION
# ============================================================================

# Generation mode: "streaming" or "batch"
generation_mode: "streaming"

# Streaming configuration
streaming_config:
  total_rows_per_second: 1000  # Total throughput across all event types
  # Results in:
  # - user.page_view: 600 events/sec
  # - user.click: 300 events/sec
  # - user.purchase: 100 events/sec

# Serialization format for payloads
serialization_format: "json"  # Options: "json", "avro", "binary", "protobuf"

# Sink configuration
sink_config:
  type: "kinesis"  # Options: "kinesis", "kafka", "eventhubs", "delta"
  
  # Kinesis-specific settings
  stream_name: "web-events-stream"
  region: "us-east-1"
  
  # Which field to use for Kinesis partitioning
  partition_key_field: "user_id"
  
  # AUTHENTICATION (choose ONE):
  # Option 1: Unity Catalog service credential (single-user clusters, auto-refresh)
  service_credential_name: "my-kinesis-credential"
  
  # Option 2: Direct credentials from Databricks secrets (legacy)
  # aws_access_key_id: "{{secrets/my-scope/aws-access-key}}"
  # aws_secret_access_key: "{{secrets/my-scope/aws-secret-key}}"
  
  # Option 3: Cluster instance profile (omit credentials - automatic)

# ============================================================================
# SCHEMA CONFIGURATION
# ============================================================================

# Common fields that appear in ALL event types
common_fields:
  event_timestamp:
    type: "timestamp"  # When the event occurred
  
  user_id:
    type: "int"
    range: [1, 1000000]  # 1 million unique users
  
  session_id:
    type: "uuid"  # Unique session identifier

# Event type definitions with weights (must sum to 1.0)
event_types:
  # Page view events (60% of traffic)
  - event_type_id: "user.page_view"
    weight: 0.60
    fields:
      page_url:
        type: "string"
        values: ["/home", "/products", "/cart", "/checkout", "/about"]
        weights: [0.40, 0.30, 0.15, 0.10, 0.05]
      referrer:
        type: "string"
        values: ["direct", "google", "facebook", "email", "other"]
        weights: [0.30, 0.35, 0.15, 0.10, 0.10]
  
  # Click events (30% of traffic)
  - event_type_id: "user.click"
    weight: 0.30
    fields:
      element_id:
        type: "string"
        values: ["btn_buy", "btn_add_cart", "link_product", "btn_search", "link_footer"]
        weights: [0.25, 0.30, 0.25, 0.15, 0.05]
      element_type:
        type: "string"
        values: ["button", "link", "image"]
        weights: [0.50, 0.40, 0.10]
  
  # Purchase events (10% of traffic)
  - event_type_id: "user.purchase"
    weight: 0.10
    fields:
      transaction_id:
        type: "uuid"
      amount:
        type: "float"
        range: [10.0, 500.0]
      product_count:
        type: "int"
        range: [1, 10]

# ============================================================================
# NOTES
# ============================================================================
# - Weights MUST sum to 1.0 (validated at config load)
# - total_rows_per_second is distributed by weights
# - All fields in common_fields appear in every event type
# - Event-specific fields only appear in that event type
